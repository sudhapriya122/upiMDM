var batchDataModule=angular.module("MDM.batchData",["ngRoute","ngMessages"]);batchDataModule.controller("batchDataCtrl",["$scope","$location","$filter","$routeParams","LoginCredsFactory","PlatwareRequest","parsePlatwareResponse","dmDialogueBox","entityListService","$q",function(l,f,i,k,g,a,d,e,j,h){var b=k.batchid;var c=k.entityid;l.curEntityId=c;l.showScreenControls.showBatchTable=false;l.curBatchId=b;l.getBatchData=function(n){l.showLoader();l.showScreenControls.showBatchTable=false;var m=[{processName:"SPGETVIEWDATA",data:[{x_start_index:(parseInt(n))+1+"",x_entityid:l.curEntityId,x_batch_id:l.curBatchId}]}];a.callPlatware(m).success(function(s){var t=[];var p=d.parse(s);for(var r=0,o=p.length;r<o;r++){if(p[r]["isError"]=="N"){t=p[r]["data"];var q={};q.totalRec=t[0]["total_records"];q.recPerRes=t[0]["batch_count"];l.collectiveServerCalls={showServerPagination:true,totalRecordCount:q.totalRec,batchCount:q.recPerRes};l.hideLoader();l.showScreenControls.showBatchTable=true;l.batchRowData=t}else{l.hideLoader();e.alertBox({title:"Alert",message:"Error From Server Side",actionlabel:["Ok"]}).then(function(u){})}}}).error(function(o){l.hideLoader();e.alertBox({title:"Alert",message:"Error From Server Side",actionlabel:["Ok"]}).then(function(p){})})};l.getCurrentBatchData=function(){var m=[{processName:"SPCOUNTRECORD",data:[{x_entityid:l.curEntityId,x_batch_id:l.curBatchId}]}];l.showLoader("Getting Batch Records");a.callPlatware(m).success(function(n){var o={};var q=d.parse(n);for(var p=0;p<q.length;p++){o.totalRec=q[p]["data"][p]["total_records"];o.recPerRes=q[p]["data"][p]["batch_count"]}l.collectiveServerCalls={showServerPagination:true,totalRecordCount:o.totalRec,batchCount:o.recPerRes};l.getBatchData("0")}).error(function(){l.hideLoader();e.alertBox({title:"Oops !!",message:"Some Error occured..Please try again!!",iconType:"interneterror"})})};l.$on("sessionValidateEvent",function(n,m){if(m){try{l.actionBatch={};l.actionBatch.name="Batch Data";l.actionBatch.action="batchData";l.setPath(l.actionBatch);l.getBatchData("0")}catch(n){}}else{e.alertBox({title:"Error",message:"Invalid user or session, kindly login again",actionlabel:["Ok"]}).then(function(o){f.path("/login")})}})}]);
self.onmessage=function(g){self.importScripts("js/jszip.js","js/xls.js","js/xlsx.js");var a=g.data.file;var n="";var f="";var m={};var d=function(r,s){var o={fileType:n,sheets:"",fileData:r||"",errorMessage:f};switch(n.toLowerCase()){case"xls":case"xlsx":if(s){var e=[];for(var p=0,q=s.length;p<q;p++){if((s[p].length>0&&s[p].toLowerCase()=="configuration_not to be touched")||(s[p].length>0&&s[p].toLowerCase()=="validations")){}else{e.push(s[p])}}s=e;o.sheets=s||""}break;case"csv":o.sheets="";break;default:}postMessage(o)};var c=function(o){var e=o.SheetNames;e.forEach(function(q){var p=o.Sheets[q];for(z in p){if(z[0]==="!"){continue}console.log(q+"!"+z+"="+JSON.stringify(p[z].v))}})};var j=function(q){var p=q.SheetNames;for(var e=0;e<p.length;e++){var o=XLSX.utils.make_csv(q.Sheets[p[e]]);m[p[e]]=o.trim()}d(m,p)};var b=function(q){var o=/^\s*(?:'[^'\\]*(?:\\[\S\s][^'\\]*)*'|"[^"\\]*(?:\\[\S\s][^"\\]*)*"|[^,'"\s\\]*(?:\s+[^,'"\s\\]+)*)\s*(?:,\s*(?:'[^'\\]*(?:\\[\S\s][^'\\]*)*'|"[^"\\]*(?:\\[\S\s][^"\\]*)*"|[^,'"\s\\]*(?:\s+[^,'"\s\\]+)*)\s*)*$/;var p=/(?!\s*$)\s*(?:'([^'\\]*(?:\\[\S\s][^'\\]*)*)'|"([^"\\]*(?:\\[\S\s][^"\\]*)*)"|([^,'"\s\\]*(?:\s+[^,'"\s\\]+)*))\s*(?:,|$)/g;if(!o.test(q)){return null}var e=[];q.replace(p,function(u,t,s,r){if(t!==undefined){e.push(t.replace(/\\'/g,"'"))}else{if(s!==undefined){e.push(s.replace(/\\"/g,'"'))}else{if(r!==undefined){e.push(r)}}}return""});if(/,\s*$/.test(q)){e.push("")}return e};var i=function(o){try{var v=o.target.result.trim();var y=v.split("\n");var q=[];for(var r=0,x=y.length;r<x;r++){var w=b(y[r]);for(var p=0,s=w.length;p<s;p++){if(w[p].indexOf(",")>-1){w[p]=w[p].replace(/,/g,"^^")}if(w[p].indexOf("\n")>-1){w[p]=w[p].replace(/\n/g,"")}}var u=w.join(",");q.push(u)}v=q.join("\n");d(v)}catch(t){f="File Corrupted..Load Another File";d()}};var k=function(o){var t=new FileReader();try{if("readAsBinaryString" in t){var r=o.target.result}else{var r="";var w=new Uint8Array(o.target.result);var p=w.byteLength;for(var s=0;s<p;s++){r+=String.fromCharCode(w[s])}}var v=XLSX.CFB.read(r,{type:"binary"});var q=XLSX.parse_xlscfb(v);j(q)}catch(u){f="File Corrupted..Load Another File";d()}};var h=function(s){var q=new FileReader();try{if("readAsBinaryString" in q){var u=s.target.result}else{var u="";var o=new Uint8Array(s.target.result);var r=o.byteLength;for(var p=0;p<r;p++){u+=String.fromCharCode(o[p])}}var t=XLSX.read(u,{type:"binary"});j(t)}catch(v){f="File Corrupted..Load Another File"}};var l=function(){n=a.name.substr(a.name.lastIndexOf(".")+1);if(n.toLowerCase()==="csv"||n.toLowerCase()==="xls"||n.toLowerCase()==="xlsx"){var e=new FileReader();switch(n.toLowerCase()){case"csv":e.onload=i;break;case"xls":e.onload=k;break;case"xlsx":e.onload=h;default:break}if("readAsBinaryString" in e){e.readAsBinaryString(a)}else{switch(n.toLowerCase()){case"xlsx":case"xls":e.readAsArrayBuffer(a);break;case"csv":e.readAsText(a);break}}}else{f="Invalid File Type..";d();return}};l()};